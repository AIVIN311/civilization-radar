# v0.5 Release Notes

## v0.5 PR-2 Scope

This PR implements geo factor data-layer outputs only.

- Adds `config/geo_profiles_v1.json` as the SSOT for geo profiles.
- Adds `src/geo_factor.py` with deterministic geo factor / TW rank computation.
- Adds chain output columns:
  - `geo_profile`
  - `geo_factor`
  - `geo_factor_explain_json`
  - `tw_rank_score`
  - `tw_rank_explain_json`
- Adds `run_pipeline_50.py --geo-profile` and forwards it to `build_chain_matrix_v10.py`.
- Extends dashboard chain table display with `geo_factor` and `tw_rank_score`.

## Non-Interference Contract

v0.5 PR-2 must not alter v0.4 core semantics:

- `base_score` semantics unchanged.
- `boosted_score` semantics unchanged.
- `delta_boost` semantics unchanged.
- `scripts/run_acceptance_v04.py` is not edited.

`tw_rank_score` is derived only from existing chain push output:

`tw_rank_score = boosted_push * (1 + geo_factor)`

## SSOT Path Rule

The formal SSOT path is fixed to:

- `config/geo_profiles_v1.json`

Legacy root-level `geo_profiles_v1.json` is migration-only history and should not be used by runtime defaults.

## v0.5 PR-3 Scope (UI-only)

This PR adds dashboard interaction controls for geo fields without changing any backend compute path.

- Adds chain-level geo controls in `dashboard_v04.html` output:
  - geo column toggle
  - profile filter
  - gate filter
  - `geo_factor > 0` filter
  - sort selector (`default`, `tw_rank_score`, `geo_factor`, `boosted_push`)
- Adds explain expansion for:
  - `geo_factor_explain_json`
  - `tw_rank_explain_json`

## PR-3 Non-Interference

PR-3 does not change:

- `build_chain_matrix_v10.py` compute semantics
- `src/geo_factor.py` formulas
- DB schema or migrations
- default SQL ordering semantics (`default` mode preserves original order)

PR-3 is a render-layer usability/readability enhancement only.

## v0.5 PR-4 (Acceptance)

Run v0.5 acceptance (geo scenarios + non-interference):

```bash
python scripts/run_acceptance_v05.py
```

Optional:

```bash
python scripts/run_acceptance_v05.py --skip-v04-hash
python scripts/run_acceptance_v05.py --output-root output/acceptance_v05
```

Notes:

- Uses `input/snapshots.geo.sample.jsonl` (TW / nearby / none).
- Validates v0.5 geo fields + explain contracts.
- Ensures v0.4 acceptance summary hash remains unchanged.
